"use strict";
var dir = new URL(window.location.href);
dir.hash = "", dir.search = "";
var ifrcb30Searcher = document.getElementById("cb30Searcher");
null != ifrcb30Searcher && (
    ifrcb30Searcher.src = getSrc("cb30Searcher", dir.href, ifrcb30Searcher.src, window.location.search),
    document.querySelector("iframe").addEventListener("load",
        (function() {
            $("#cb30Searcher").iFrameResize({
                log: false, // Enable console logging
                enablePublicMethods: true, // Enable methods within iframe hosted page
                heightCalculationMethod: 'lowestElement',
                autoResize: true,
                resizeFrom: 'child',
                tolerance: 10,
                onResized: function(messageData) { // Callback fn when resize is received
                    $('p#callback').html(
                        '<b>Frame ID:</b> ' + messageData.iframe.id +
                        ' <b>Height:</b> ' + messageData.height +
                        ' <b>Width:</b> ' + messageData.width +
                        ' <b>Event type:</b> ' + messageData.type
                    );
                },
                onMessage: function(messageData) { // Callback fn when message is received
                    $('p#callback').html(
                        '<b>Frame ID:</b> ' + messageData.iframe.id +
                        ' <b>Message:</b> ' + messageData.message
                    );
                    alert(messageData.message);
                },
                onClosed: function(id) { // Callback fn when iFrame is closed
                    $('p#callback').html(
                        '<b>IFrame (</b>' + id +
                        '<b>) removed from page.</b>'
                    );
                }
            });
        })
    )
);
var ifrBannerSearch = document.getElementById("cb30BannerSearch");
null != ifrBannerSearch && (
    ifrBannerSearch.src = getSrc("cb30BannerSearch", dir.href, ifrBannerSearch.src, window.location.search),
    document.querySelector("iframe").addEventListener("load",
        (function() {
            $("#cb30BannerSearch").iFrameResize({
                log: true, // Enable console logging
                enablePublicMethods: true, // Enable methods within iframe hosted page
                heightCalculationMethod: 'lowestElement',
                autoResize: false,
                resizeFrom: 'child',
                onResized: function(messageData) { // Callback fn when resize is received
                    $('p#callback').html(
                        '<b>Frame ID:</b> ' + messageData.iframe.id +
                        ' <b>Height:</b> ' + messageData.height +
                        ' <b>Width:</b> ' + messageData.width +
                        ' <b>Event type:</b> ' + messageData.type
                    );
                },
                onMessage: function(messageData) { // Callback fn when message is received
                    $('p#callback').html(
                        '<b>Frame ID:</b> ' + messageData.iframe.id +
                        ' <b>Message:</b> ' + messageData.message
                    );
                    alert(messageData.message);
                },
                onClosed: function(id) { // Callback fn when iFrame is closed
                    $('p#callback').html(
                        '<b>IFrame (</b>' + id +
                        '<b>) removed from page.</b>'
                    );
                }
            });
        })
    )
);
var ifrcb3OfferBanner = document.getElementById("cb3OfferBanner");
null != ifrcb3OfferBanner && (
    ifrcb3OfferBanner.src = getSrc("cb3OfferBanner", dir.href, ifrcb3OfferBanner.src, window.location.search),
    document.querySelector("iframe").addEventListener("load",
        (function() {
            $("#cb3OfferBanner").iFrameResize({
                log: true, // Enable console logging
                enablePublicMethods: true, // Enable methods within iframe hosted page
                heightCalculationMethod: 'lowestElement',
                autoResize: false,
                resizeFrom: 'child',
                onResized: function(messageData) { // Callback fn when resize is received
                    $('p#callback').html(
                        '<b>Frame ID:</b> ' + messageData.iframe.id +
                        ' <b>Height:</b> ' + messageData.height +
                        ' <b>Width:</b> ' + messageData.width +
                        ' <b>Event type:</b> ' + messageData.type
                    );
                },
                onMessage: function(messageData) { // Callback fn when message is received
                    $('p#callback').html(
                        '<b>Frame ID:</b> ' + messageData.iframe.id +
                        ' <b>Message:</b> ' + messageData.message
                    );
                    alert(messageData.message);
                },
                onClosed: function(id) { // Callback fn when iFrame is closed
                    $('p#callback').html(
                        '<b>IFrame (</b>' + id +
                        '<b>) removed from page.</b>'
                    );
                }
            });
        })
    )
);
var ifrcb30MiniSearch = document.getElementById("cb30MiniSearch");
null != ifrcb30MiniSearch && (
    ifrcb30MiniSearch.src = getSrc("cb30MiniSearch", dir.href, ifrcb30MiniSearch.src, window.location.search),
    document.querySelector("iframe").addEventListener("load",
        (function() {
            $("#cb30MiniSearch").iFrameResize({
                log: true, // Enable console logging
                enablePublicMethods: true, // Enable methods within iframe hosted page
                heightCalculationMethod: 'lowestElement',
                autoResize: false,
                resizeFrom: 'child',
                onResized: function(messageData) { // Callback fn when resize is received
                    $('p#callback').html(
                        '<b>Frame ID:</b> ' + messageData.iframe.id +
                        ' <b>Height:</b> ' + messageData.height +
                        ' <b>Width:</b> ' + messageData.width +
                        ' <b>Event type:</b> ' + messageData.type
                    );
                },
                onMessage: function(messageData) { // Callback fn when message is received
                    $('p#callback').html(
                        '<b>Frame ID:</b> ' + messageData.iframe.id +
                        ' <b>Message:</b> ' + messageData.message
                    );
                    alert(messageData.message);
                },
                onClosed: function(id) { // Callback fn when iFrame is closed
                    $('p#callback').html(
                        '<b>IFrame (</b>' + id +
                        '<b>) removed from page.</b>'
                    );
                }
            });
        })
    )
);

function getSrc(typeObj, urlParent, urlIframe, urlParam) {
    var parentUrl = new URLSearchParams(urlParam),
        ifrUrl = new URL(urlIframe);
    switch (typeObj) {
        case "cb30Searcher":
            ifrUrl.searchParams.set("urlConexion", dir);
            break;
        case "cb30BannerSearch":
            ifrUrl.searchParams.set("url", dir), ifrUrl.searchParams.set("SearcherBanner", "Y");
            break;
        case "cb30MiniSearch":
            ifrUrl.searchParams.set("url", dir), ifrUrl.searchParams.set("MiniSearcherV", "Y");
            break;
        case "cb3OfferBanner":
            ifrUrl.searchParams.set("url", dir), ifrUrl.searchParams.set("MiniOfferV", "Y")
    }
    for (const [key, value] of parentUrl) ifrUrl.searchParams.set(key, value);
    return ifrUrl.href
}